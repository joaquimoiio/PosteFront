<!DOCTYPE html>
<html lang="pt-BR">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description" content="Gerenciamento de Despesas - Sistema de Vendas de Postes">
    <meta http-equiv="Content-Language" content="pt-BR">
    <title>Despesas - Gerenciador de Vendas de Postes</title>
    <link rel="stylesheet" href="css/despesas.css">
    <style>
        /* Estilos especÃ­ficos para calendÃ¡rio brasileiro */
        input[type="date"] {
            font-family: inherit;
            color-scheme: light;
        }
        
        .date-help {
            font-size: 0.75rem;
            color: var(--gray-500);
            margin-top: var(--space-1);
            font-style: italic;
        }
        
        input[type="date"]::-webkit-calendar-picker-indicator {
            background-image: url("data:image/svg+xml;charset=UTF-8,%3csvg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 20 20' fill='currentColor'%3e%3cpath fill-rule='evenodd' d='M6 2a1 1 0 00-1 1v1H4a2 2 0 00-2 2v10a2 2 0 002 2h12a2 2 0 002-2V6a2 2 0 00-2-2h-1V3a1 1 0 10-2 0v1H7V3a1 1 0 00-1-1zm0 5a1 1 0 000 2h8a1 1 0 100-2H6z' clip-rule='evenodd'/%3e%3c/svg%3e");
            background-size: 16px 16px;
            background-repeat: no-repeat;
            background-position: center;
            cursor: pointer;
            opacity: 0.7;
            transition: opacity 0.2s ease;
        }
        
        input[type="date"]::-webkit-calendar-picker-indicator:hover {
            opacity: 1;
        }

        /* Melhorias de acessibilidade */
        .sr-only {
            position: absolute;
            width: 1px;
            height: 1px;
            padding: 0;
            margin: -1px;
            overflow: hidden;
            clip: rect(0, 0, 0, 0);
            white-space: nowrap;
            border: 0;
        }
    </style>
</head>
<body>
    <!-- Header Principal -->
    <header class="header" role="banner">
        <div class="header-content">
            <h1>âš¡ Gerenciador de Vendas de Postes</h1>
            <p>Despesas - Controle Financeiro</p>
        </div>
    </header>

    <!-- NavegaÃ§Ã£o Principal -->
    <nav class="main-nav" role="navigation" aria-label="NavegaÃ§Ã£o principal">
        <div class="nav-container">
            <a href="index.html" class="nav-item">
                <span class="nav-icon" aria-hidden="true">ğŸ“Š</span>
                <span class="nav-text">Dashboard</span>
            </a>
            <a href="vendas.html" class="nav-item">
                <span class="nav-icon" aria-hidden="true">ğŸ“‹</span>
                <span class="nav-text">Vendas</span>
            </a>
            <a href="despesas.html" class="nav-item active" aria-current="page">
                <span class="nav-icon" aria-hidden="true">ğŸ’¸</span>
                <span class="nav-text">Despesas</span>
            </a>
            <a href="postes.html" class="nav-item">
                <span class="nav-icon" aria-hidden="true">âš¡</span>
                <span class="nav-text">Postes</span>
            </a>
        </div>
    </nav>

    <!-- ConteÃºdo Principal -->
    <main class="main-content" role="main">
        <div class="despesas-page">

            <!-- SeÃ§Ã£o: Cadastro de Nova Despesa -->
            <section class="form-section" aria-labelledby="nova-despesa-titulo">
                <header class="section-header">
                    <h2 id="nova-despesa-titulo">â• Cadastrar Nova Despesa</h2>
                    <p class="section-description">Registre uma nova despesa no sistema</p>
                </header>

                <form id="despesa-form" class="form-container" novalidate aria-labelledby="nova-despesa-titulo">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="despesa-data" class="form-label">
                                ğŸ“… Data da Despesa
                                <span class="required" aria-label="Campo obrigatÃ³rio">*</span>
                            </label>
                            <input 
                                type="date" 
                                id="despesa-data" 
                                class="form-input"
                                required 
                                aria-describedby="data-help"
                                lang="pt-BR"
                            >
                            <small id="data-help" class="date-help">
                                Data quando a despesa foi realizada
                            </small>
                        </div>

                        <div class="form-group">
                            <label for="despesa-valor" class="form-label">
                                Valor
                                <span class="required" aria-label="Campo obrigatÃ³rio">*</span>
                            </label>
                            <div class="input-with-icon">
                                <span class="input-icon" aria-hidden="true">ğŸ’°</span>
                                <input 
                                    type="number" 
                                    step="0.01" 
                                    id="despesa-valor" 
                                    class="form-input"
                                    required 
                                    placeholder="0,00" 
                                    min="0.01"
                                    max="999999.99"
                                    aria-describedby="valor-help"
                                >
                            </div>
                            <small id="valor-help" class="form-help">
                                Valor em reais (R$)
                            </small>
                        </div>

                        <div class="form-group full-width">
                            <label for="despesa-descricao" class="form-label">
                                DescriÃ§Ã£o da Despesa
                                <span class="required" aria-label="Campo obrigatÃ³rio">*</span>
                            </label>
                            <input 
                                type="text" 
                                id="despesa-descricao" 
                                class="form-input"
                                required 
                                placeholder="Ex: Pagamento de funcionÃ¡rio, combustÃ­vel, material..."
                                aria-describedby="descricao-help"
                                minlength="3"
                                maxlength="500"
                            >
                            <small id="descricao-help" class="form-help">
                                Descreva brevemente o tipo de despesa
                            </small>
                        </div>

                        <div class="form-group">
                            <label for="despesa-tipo" class="form-label">
                                Categoria da Despesa
                                <span class="required" aria-label="Campo obrigatÃ³rio">*</span>
                            </label>
                            <select id="despesa-tipo" class="form-select" required aria-describedby="tipo-help">
                                <option value="">Selecione a categoria</option>
                                <option value="FUNCIONARIO">ğŸ’¼ Despesa para FuncionÃ¡rio</option>
                                <option value="OUTRAS">ğŸ“‹ Outras Despesas</option>
                            </select>
                            <small id="tipo-help" class="form-help">
                                Escolha se afeta todos os sÃ³cios ou sÃ³ G&J
                            </small>
                        </div>
                    </div>

                    <div class="form-actions">
                        <button type="submit" class="btn btn-primary">
                            <span class="btn-icon" aria-hidden="true">ğŸ’¾</span>
                            Salvar Despesa
                        </button>
                        <button type="reset" class="btn btn-secondary">
                            <span class="btn-icon" aria-hidden="true">ğŸ”„</span>
                            Limpar Campos
                        </button>
                    </div>
                </form>
            </section>

            <!-- SeÃ§Ã£o: Resumo das Despesas -->
            <section class="summary-section" aria-labelledby="resumo-titulo">
                <header class="section-header">
                    <h2 id="resumo-titulo">ğŸ“Š Resumo das Despesas</h2>
                    <p class="section-description">VisÃ£o geral das despesas por categoria</p>
                </header>

                <div class="summary-cards" role="group" aria-label="Resumo de despesas">
                    <article class="summary-card expense-funcionario" aria-labelledby="funcionario-resumo">
                        <div class="card-content">
                            <h3 id="funcionario-resumo">ğŸ’¼ Despesas FuncionÃ¡rio</h3>
                            <div class="summary-value" id="total-despesas-funcionario" aria-live="polite">R$ 0,00</div>
                            <small class="card-note">Afeta apenas G&J (25% cada)</small>
                        </div>
                    </article>

                    <article class="summary-card expense-total" aria-labelledby="outras-resumo">
                        <div class="card-content">
                            <h3 id="outras-resumo">ğŸ“‹ Outras Despesas</h3>
                            <div class="summary-value" id="total-outras-despesas" aria-live="polite">R$ 0,00</div>
                            <small class="card-note">Afeta lucro total de todos</small>
                        </div>
                    </article>

                    <article class="summary-card neutral" aria-labelledby="total-resumo">
                        <div class="card-content">
                            <h3 id="total-resumo">ğŸ’¸ Total Geral</h3>
                            <div class="summary-value" id="total-despesas-geral" aria-live="polite">R$ 0,00</div>
                            <small class="card-note">Soma de todas as despesas</small>
                        </div>
                    </article>
                </div>

                <!-- Painel Informativo -->
                <div class="info-panel" role="region" aria-labelledby="info-categorias">
                    <h3 id="info-categorias">â„¹ï¸ DiferenÃ§a entre Categorias</h3>
                    <div class="info-grid">
                        <div class="info-item">
                            <strong class="text-warning">ğŸ’¼ FuncionÃ¡rio:</strong>
                            <span>Reduz apenas a parte de Gilberto e Jefferson (25% cada)</span>
                        </div>
                        <div class="info-item">
                            <strong class="text-danger">ğŸ“‹ Outras:</strong>
                            <span>Reduz o lucro total de todos os sÃ³cios (CÃ­cero 50%, G&J 25% cada)</span>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SeÃ§Ã£o: Filtros -->
            <section class="table-section" aria-labelledby="filtros-titulo">
                <header class="section-header">
                    <h2 id="filtros-titulo">ğŸ” Filtros de Busca</h2>
                    <p class="section-description">
                        Use os filtros para refinar sua pesquisa. Por padrÃ£o, mostra despesas do mÃªs atual.
                    </p>
                </header>
                
                <div class="table-filters" role="search" aria-label="Filtros de despesas">
                    <div class="filter-grid">
                        <div class="filter-group">
                            <label for="filtro-tipo" class="filter-label">Categoria</label>
                            <select id="filtro-tipo" class="filter-select" aria-describedby="filtro-tipo-help">
                                <option value="">Todas as categorias</option>
                                <option value="FUNCIONARIO">ğŸ’¼ FuncionÃ¡rio</option>
                                <option value="OUTRAS">ğŸ“‹ Outras</option>
                            </select>
                            <small id="filtro-tipo-help" class="filter-help">
                                Filtrar por tipo de despesa
                            </small>
                        </div>

                        <div class="filter-group">
                            <label for="filtro-data-inicio" class="filter-label">ğŸ“… Data InÃ­cio</label>
                            <input 
                                type="date" 
                                id="filtro-data-inicio" 
                                class="filter-input"
                                lang="pt-BR"
                                aria-describedby="data-inicio-help"
                            >
                            <small id="data-inicio-help" class="date-help">
                                Data inicial do perÃ­odo
                            </small>
                        </div>

                        <div class="filter-group">
                            <label for="filtro-data-fim" class="filter-label">ğŸ“… Data Fim</label>
                            <input 
                                type="date" 
                                id="filtro-data-fim" 
                                class="filter-input"
                                lang="pt-BR"
                                aria-describedby="data-fim-help"
                            >
                            <small id="data-fim-help" class="date-help">
                                Data final do perÃ­odo
                            </small>
                        </div>

                        <div class="filter-group">
                            <label for="filtro-descricao" class="filter-label">DescriÃ§Ã£o</label>
                            <input 
                                type="text" 
                                id="filtro-descricao" 
                                class="filter-input"
                                placeholder="Buscar na descriÃ§Ã£o..."
                                aria-describedby="descricao-filtro-help"
                            >
                            <small id="descricao-filtro-help" class="filter-help">
                                Busca por texto na descriÃ§Ã£o
                            </small>
                        </div>

                        <div class="filter-group filter-actions">
                            <button 
                                type="button" 
                                class="btn btn-secondary btn-small" 
                                onclick="limparFiltros()"
                                aria-label="Limpar todos os filtros aplicados"
                            >
                                <span class="btn-icon" aria-hidden="true">ğŸ§¹</span>
                                Limpar Filtros
                            </button>
                        </div>
                    </div>
                </div>
            </section>

            <!-- SeÃ§Ã£o: Lista de Despesas -->
            <section class="table-section" aria-labelledby="lista-titulo">
                <header class="section-header">
                    <h2 id="lista-titulo">ğŸ“‹ Despesas Cadastradas</h2>
                    <div class="section-actions">
                        <button 
                            type="button" 
                            class="btn btn-secondary btn-small" 
                            onclick="loadDespesas()"
                            aria-label="Atualizar lista de despesas"
                        >
                            <span class="btn-icon" aria-hidden="true">ğŸ”„</span>
                            Atualizar
                        </button>
                        <button 
                            type="button" 
                            class="btn btn-secondary btn-small" 
                            onclick="exportarDespesas()"
                            aria-label="Exportar despesas para arquivo"
                        >
                            <span class="btn-icon" aria-hidden="true">ğŸ“Š</span>
                            Exportar
                        </button>
                    </div>
                </header>

                <div class="table-container" role="region" aria-labelledby="lista-titulo" tabindex="0">
                    <table id="despesas-table" class="data-table" role="table" aria-label="Lista de despesas">
                        <thead>
                            <tr role="row">
                                <th scope="col" class="sortable">Data</th>
                                <th scope="col" class="sortable">DescriÃ§Ã£o</th>
                                <th scope="col" class="sortable">Valor</th>
                                <th scope="col" class="sortable">Categoria</th>
                                <th scope="col">AÃ§Ãµes</th>
                            </tr>
                        </thead>
                        <tbody>
                            <tr>
                                <td colspan="5" class="empty-table">
                                    <div class="empty-state">
                                        <div class="empty-table-icon" aria-hidden="true">ğŸ’¸</div>
                                        <h3>Nenhuma despesa encontrada</h3>
                                        <p>Comece cadastrando sua primeira despesa no formulÃ¡rio acima.</p>
                                        <button 
                                            type="button" 
                                            class="btn btn-primary" 
                                            onclick="scrollToForm()"
                                            aria-label="Ir para formulÃ¡rio de cadastro"
                                        >
                                            Cadastrar Primeira Despesa
                                        </button>
                                    </div>
                                </td>
                            </tr>
                        </tbody>
                    </table>
                </div>
            </section>

        </div>
    </main>

    <!-- Modal: EdiÃ§Ã£o de Despesa -->
    <div id="edit-despesa-modal" class="modal" role="dialog" aria-labelledby="modal-titulo" aria-hidden="true">
        <div class="modal-content">
            <header class="modal-header">
                <h2 id="modal-titulo">âœï¸ Editar Despesa</h2>
                <button 
                    type="button" 
                    class="close" 
                    onclick="closeModal('edit-despesa-modal')"
                    aria-label="Fechar modal de ediÃ§Ã£o"
                >
                    <span aria-hidden="true">&times;</span>
                </button>
            </header>
            
            <form id="edit-despesa-form" novalidate>
                <div class="modal-body">
                    <div class="form-grid">
                        <div class="form-group">
                            <label for="edit-despesa-data" class="form-label">
                                ğŸ“… Data da Despesa
                                <span class="required" aria-label="Campo obrigatÃ³rio">*</span>
                            </label>
                            <input 
                                type="date" 
                                id="edit-despesa-data" 
                                class="form-input"
                                required
                                lang="pt-BR"
                            >
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-despesa-valor" class="form-label">
                                Valor
                                <span class="required" aria-label="Campo obrigatÃ³rio">*</span>
                            </label>
                            <input 
                                type="number" 
                                step="0.01" 
                                id="edit-despesa-valor" 
                                class="form-input"
                                required 
                                min="0.01"
                                max="999999.99"
                            >
                        </div>

                        <div class="form-group full-width">
                            <label for="edit-despesa-descricao" class="form-label">
                                DescriÃ§Ã£o
                                <span class="required" aria-label="Campo obrigatÃ³rio">*</span>
                            </label>
                            <input 
                                type="text" 
                                id="edit-despesa-descricao" 
                                class="form-input"
                                required
                                minlength="3"
                                maxlength="500"
                            >
                        </div>
                        
                        <div class="form-group">
                            <label for="edit-despesa-tipo" class="form-label">
                                Categoria
                                <span class="required" aria-label="Campo obrigatÃ³rio">*</span>
                            </label>
                            <select id="edit-despesa-tipo" class="form-select" required>
                                <option value="FUNCIONARIO">ğŸ’¼ Despesa para FuncionÃ¡rio</option>
                                <option value="OUTRAS">ğŸ“‹ Outras Despesas</option>
                            </select>
                        </div>
                    </div>
                </div>
                
                <footer class="modal-actions">
                    <button type="submit" class="btn btn-primary">
                        <span class="btn-icon" aria-hidden="true">ğŸ’¾</span>
                        Salvar AlteraÃ§Ãµes
                    </button>
                    <button 
                        type="button" 
                        class="btn btn-secondary" 
                        onclick="closeModal('edit-despesa-modal')"
                    >
                        Cancelar
                    </button>
                </footer>
            </form>
        </div>
    </div>

    <!-- Overlay de Carregamento -->
    <div id="loading-overlay" class="loading-overlay" role="status" aria-live="polite" aria-hidden="true">
        <div class="spinner" aria-hidden="true"></div>
        <p>Carregando dados das despesas...</p>
    </div>

    <!-- Container de Alertas -->
    <div id="alert-container" class="alert-container" role="alert" aria-live="assertive" aria-atomic="true"></div>

    <!-- Scripts -->
    <script src="js/despesas.js"></script>
</body>
</html>